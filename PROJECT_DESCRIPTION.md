# 2026.02.10 Описание проекта ParserSteel

# Коммерческое описание системы ParserSteel
## Профессиональный электронный марочник сталей и сплавов

---

## 1. Описание проекта

### 1.1. Определение проблемы

**Проблема:**
Компания тратит значительное количество времени на рутинные операции:
- Поиск аналогов марок сталей и сплавов по различным стандартам (ГОСТ, AISI, DIN, JIS, GB)
- Сравнение химического состава марок с указанными в запросах клиентов
- Подбор альтернативных материалов при отсутствии запрашиваемой марки
- Ручной поиск информации по редким и нестандартным маркам производителей
- Формирование сравнительных таблиц для технической документации

**Текущие затраты времени:** от 15 до 60 минут на один запрос по сложным маркам

### 1.2. Предлагаемое решение

**Решение:**
Автоматизация поиска и сравнения марок сталей с использованием:
- Единой базы данных из 9,600+ марок стали
- AI-powered поиска неизвестных марок через нейросети (Perplexity AI)
- Fuzzy-алгоритма поиска похожих марок по химическому составу
- Мгновенного сравнения нескольких марок в одной таблице

**Сокращение времени:** с 15-60 минут до 10-30 секунд

### 1.3. Идея проекта

Создание комплексной системы для работы с марками сталей и сплавов:

1. **База данных** - сбор данных через парсинг профессиональных источников (zknives.com, splav.kz, metallicheckiy-portal.ru)
2. **AI-интеграция** - поиск неизвестных и нестандартных марок через Perplexity API с доступом к интернету
3. **Web-интерфейс** - профессиональное приложение с фильтрами и сравнением
4. **Telegram-бот** - мобильный доступ с распознаванием естественного языка через GPT-4

### 1.4. Используемые технологии

**Backend:**
- Python 3.11 - основной язык программирования
- Flask - RESTful API сервер
- SQLite - база данных с WAL-режимом для конкурентного доступа
- BeautifulSoup, lxml, Selenium - парсинг веб-сайтов

**AI-интеграция:**
- Perplexity API (Sonar-Pro) - поиск редких марок в интернете в реальном времени
- OpenAI GPT-4 - fallback для распространённых марок
- GPT-4 Mini - анализ намерений пользователя в Telegram

**Frontend:**
- HTML5, CSS3, JavaScript (Vanilla)
- Адаптивный интерфейс для desktop и mobile

**DevOps:**
- Docker, Docker Compose - контейнеризация
- Nginx + Let's Encrypt - HTTPS и reverse proxy

**Telegram Bot:**
- python-telegram-bot - работа с Telegram API
- Контекстный анализатор запросов на базе GPT-4

---

## 2. Основные функции системы

### 2.1. Функциональные требования

#### 2.1.1. Поиск марок стали

- Поиск по названию марки (точный и частичный)
- Поиск по химическому составу (14 элементов: C, Cr, Ni, Mo, V, W, Co, Mn, Si, Cu, Nb, N, S, P)
- Фильтрация по стандартам (ГОСТ, AISI, DIN, JIS, GB, EN)
- Автоматический AI-fallback при отсутствии марки в базе данных
- Поддержка кириллицы (российские марки без транслитерации)

#### 2.1.2. Сравнение марок (Compare)

- Сравнение 2-10 марок в одной таблице
- Визуальное выделение отличий в составе
- Поддержка марок из базы данных и AI-результатов
- Отображение аналогов и стандартов

#### 2.1.3. Поиск похожих марок (Similar/Fuzzy Search)

- Алгоритм сравнения по 12 химическим элементам
- Настраиваемый допуск отклонения (tolerance, %)
- Настраиваемое количество элементов с превышением допуска
- Cross-reference анализ аналогов

#### 2.1.4. AI-поиск редких марок

- Интеграция с Perplexity API (доступ к интернету в реальном времени)
- Поиск в официальных источниках (производители, стандарты, базы данных)
- Автоматическое извлечение химического состава
- Ссылки на источники с проверкой достоверности
- Специальные инструкции для российских марок (ГОСТ)

### 2.2. Административные функции

- Добавление новых марок в базу данных
- Удаление марок из базы данных
- Автоматическое резервное копирование (ротация последних 3 бэкапов)
- Мониторинг статистики использования
- Basic Authentication для защиты веб-интерфейса
- Whitelist по Telegram ID для бота

### 2.3. Ключевые технические детали

#### 2.3.1. Архитектура системы

```
┌─────────────────────────────────────────────────────────────┐
│                   ЕДИНАЯ БАЗА ДАННЫХ                         │
│             database/steel_database.db (SQLite)              │
│                    9,614 марок стали                         │
└──────────────────────────┬──────────────────────────────────┘
                           │
                           ↓
┌─────────────────────────────────────────────────────────────┐
│                    FLASK API (app.py)                        │
│                   http://localhost:5001                       │
│                                                              │
│  Endpoints:                                                  │
│  • GET  /api/steels           - поиск марок (+ AI fallback) │
│  • POST /api/steels/compare   - сравнение марок             │
│  • POST /api/steels/fuzzy-search - поиск похожих            │
│  • POST /api/steels/add       - добавление марки            │
│  • POST /api/steels/delete    - удаление марки              │
│  • GET  /api/stats            - статистика БД               │
│                                                              │
│  Модули:                                                     │
│  • ai_search.py       - Perplexity/OpenAI интеграция        │
│  • fuzzy_search.py    - алгоритм поиска похожих марок       │
│  • database_schema.py - работа с БД                         │
└────────────────┬──────────────────────┬─────────────────────┘
                 │                      │
                 ↓                      ↓
    ┌────────────────────────┐  ┌────────────────────────┐
    │    TELEGRAM BOT        │  │    WEB ИНТЕРФЕЙС       │
    │    (клиент API)        │  │    (клиент API)        │
    │                        │  │                        │
    │ • Поиск марок          │  │ • Интерактивная таблица│
    │ • Сравнение            │  │ • Фильтры по элементам │
    │ • Похожие марки        │  │ • Сравнение марок      │
    │ • Распознавание языка  │  │ • Fuzzy Search         │
    └────────────────────────┘  └────────────────────────┘
```

#### 2.3.2. Структура базы данных

**Таблица steel_grades:**
- id (PRIMARY KEY)
- grade (название марки)
- standard (стандарт: ГОСТ, AISI, DIN, JIS, GB)
- manufacturer (производитель)
- c, cr, ni, mo, v, w, co, mn, si, cu, nb, n, s, p (химический состав)
- analogues (аналоги через разделитель |)
- link (ссылка на источник)
- base (база: Fe, Ni, Co, Ti)
- tech (технические характеристики)
- other (дополнительные элементы)

**Таблица ai_searches:**
- id (PRIMARY KEY)
- query (поисковый запрос)
- result (JSON результат)
- created_at (дата создания)
- expires_at (срок действия кэша)

---

## 3. Статистика базы данных

### 3.1. Общие показатели

| Показатель | Значение |
|------------|----------|
| **Всего марок в БД** | 9,614 |
| **С ссылками на источники** | 9,258 (96.3%) |
| **С аналогами** | 6,795 (70.7%) |
| **С правильными разделителями аналогов** | 6,500 (95.7%) |
| **С дополнительными элементами (Other)** | 2,311 (24.0%) |
| **Дубликаты** | 0 |
| **Размер базы данных** | 9.83 MB |

### 3.2. Распределение по стандартам

| Стандарт | Количество марок | Описание |
|----------|-----------------|----------|
| **ГОСТ (Россия)** | 482 | Государственные стандарты СССР/России |
| **AISI/UNS (США)** | 440 | Американские стандарты сталей и сплавов |
| **DIN (Германия)** | 419 | Немецкие материальные номера |
| **BS/EN (Европа)** | 53 | Британские и европейские стандарты |
| **GB/GB-T (Китай)** | 12 | Китайские национальные стандарты |
| **JIS (Япония)** | 6 | Японские промышленные стандарты |
| **Фирменные марки** | 5,800+ | Crucible, Bohler, Uddeholm, Erasteel и др. |

### 3.3. Ведущие производители в базе данных

**США:** Crucible (60), Carpenter (29), Latrobe (15), INCONEL (6)
**Европа:** Erasteel (54), Ossenberg (26), Bohler (10), Metal Ravne (16)
**Азия:** Hitachi (15), Tiangong (14), Heye (10), Daido (4)

---

## 4. Реализация проекта

### 4.1. Этап 1: Сбор данных (выполнено)

- Разработка парсеров для профессиональных источников
- Парсинг zknives.com (основная база ножевых сталей)
- Парсинг splav.kz (российские стандарты ГОСТ)
- Парсинг metallicheckiy-portal.ru (металлургический портал)
- Очистка и нормализация данных
- Удаление дубликатов
- Исправление разделителей аналогов

### 4.2. Этап 2: Разработка API (выполнено)

- Создание Flask REST API сервера
- Реализация endpoints для поиска, сравнения, fuzzy search
- Интеграция с Perplexity API для AI-поиска
- Настройка кэширования AI-результатов
- Добавление поддержки кириллицы без транслитерации

### 4.3. Этап 3: Web-интерфейс (выполнено)

- Разработка адаптивного HTML-интерфейса
- Интерактивная таблица с пагинацией
- Фильтры по 14 химическим элементам
- Модальные окна для Similar и Compare
- Кнопки быстрых действий

### 4.4. Этап 4: Telegram-бот (выполнено)

- Создание бота через BotFather
- Реализация команд /search, /compare, /fuzzy, /analogues
- Интеграция с GPT-4 Mini для анализа намерений
- Кнопочный интерфейс для быстрого доступа
- Поддержка естественного языка

### 4.5. Этап 5: Контейнеризация (выполнено)

- Создание Docker образов для web и бота
- Docker Compose для оркестрации
- Настройка volumes для live reload
- Конфигурация сети между контейнерами

---

## 5. Тестирование

### 5.1. Функциональное тестирование

- Проверка поиска по всем типам стандартов (ГОСТ, AISI, DIN, JIS, GB)
- Тестирование AI-поиска редких марок (K888 MATRIX, HARDOX 500)
- Проверка поиска по кириллице (16ХГМФТР, Г13, 4Х5МФС)
- Тестирование Compare с AI-марками
- Проверка Fuzzy Search с различными tolerance

### 5.2. Интеграционное тестирование

- Взаимодействие Web-интерфейса с API
- Взаимодействие Telegram-бота с API
- Конкурентный доступ к базе данных
- Работа AI-fallback при отсутствии марки

### 5.3. Нагрузочное тестирование

- Множественные одновременные запросы
- Работа SQLite в WAL-режиме
- Timeout при блокировке базы данных

---

## 6. Внедрение и передача

### 6.1. Требования к серверу

**Минимальные требования:**
- CPU: 1 ядро
- RAM: 512 MB
- Диск: 1 GB свободного места
- ОС: Linux (Ubuntu 20.04+), Windows Server 2019+

**Рекомендуемые требования:**
- CPU: 2 ядра
- RAM: 1 GB
- Диск: 5 GB SSD
- ОС: Ubuntu 22.04 LTS

### 6.2. Развертывание

1. Установка Docker и Docker Compose
2. Копирование файлов проекта на сервер
3. Создание .env файла с API ключами
4. Запуск: `docker-compose up -d --build`
5. Настройка HTTPS (Nginx + Let's Encrypt)
6. Настройка автозапуска Docker

### 6.3. Безопасность

- Basic Authentication для Web-интерфейса
- Whitelist по Telegram ID для бота
- HTTPS шифрование (Let's Encrypt)
- Защита API ключей через .env файл
- IP whitelist для внутренней сети (опционально)

---

## 7. Поддержка и обновление

### 7.1. Мониторинг

```bash
# Просмотр логов Web-сервера
docker-compose logs -f steel-parser

# Просмотр логов Telegram-бота
docker-compose logs -f telegram-bot

# Статистика ресурсов
docker stats parser-steel-app parsersteel-telegram-bot

# Проверка здоровья API
curl http://localhost:5001/api/stats
```

### 7.2. Резервное копирование

- Автоматические бэкапы при изменении БД
- Ротация последних 3 бэкапов
- Хранение в `database/backups/`
- Ручной бэкап через API

### 7.3. Обновление

```bash
# Получить обновления
git pull

# Пересобрать и перезапустить контейнеры
docker-compose up -d --build
```

---

## 8. Преимущества системы

### 8.1. Для бизнеса

- **Экономия времени:** сокращение поиска с 15-60 минут до 10-30 секунд
- **Единая база:** 9,600+ марок из разных стандартов в одном месте
- **Мобильный доступ:** Telegram-бот для быстрых запросов
- **AI-интеллект:** автоматический поиск редких марок в интернете

### 8.2. Технические

- **Модульная архитектура:** легко расширять и обслуживать
- **Docker контейнеризация:** простое развертывание и масштабирование
- **REST API:** возможность интеграции с другими системами
- **Автоматические бэкапы:** защита данных

### 8.3. Для пользователей

- **Интуитивный интерфейс:** простой и понятный
- **Fuzzy Search:** находит похожие марки даже при неполном совпадении
- **Compare:** сравнение нескольких марок в одной таблице
- **Кириллица:** работа с российскими марками без транслитерации

---

## 9. Структура проекта

```
ParserSteel/
├── app.py                    # Flask API сервер
├── config.py                 # Конфигурация приложения
├── database_schema.py        # Схема и подключение к БД
├── fuzzy_search.py           # Алгоритм поиска похожих марок
├── ai_search.py              # AI поиск через Perplexity/OpenAI
├── requirements.txt          # Python зависимости
├── Dockerfile                # Docker образ для Web
├── docker-compose.yml        # Оркестрация контейнеров
├── .env                      # Переменные окружения (API ключи)
│
├── database/
│   ├── steel_database.db     # Основная БД (9.83 MB)
│   ├── backup_manager.py     # Менеджер резервных копий
│   └── backups/              # Автоматические бэкапы
│
├── telegram_bot/
│   ├── bot.py                # Главный файл бота
│   ├── config.py             # Конфигурация бота
│   ├── context_analyzer.py   # Анализатор намерений (GPT-4)
│   ├── requirements.txt      # Зависимости бота
│   ├── Dockerfile            # Docker образ для бота
│   └── handlers/
│       ├── search.py         # Поиск марок
│       ├── compare.py        # Сравнение марок
│       ├── fuzzy_search.py   # Поиск похожих
│       └── analogues.py      # Поиск аналогов
│
└── templates/
    └── index.html            # Web-интерфейс

Размер проекта: ~13 MB (код + база данных)
```

---

## 10. Скриншоты системы

### 10.1. Web-интерфейс

*[Место для скриншота главной страницы Web-интерфейса]*

- Таблица с марками сталей
- Фильтры по химическому составу
- Кнопки Similar и Compare

### 10.2. Сравнение марок (Compare)

*[Место для скриншота модального окна Compare]*

- Сравнительная таблица нескольких марок
- Выделение отличий в составе
- Информация об аналогах и стандартах

### 10.3. Telegram-бот

*[Место для скриншота интерфейса Telegram-бота]*

- Кнопочное меню
- Пример поиска марки
- AI-результат для редкой марки

---

## 11. Заключение

Система **ParserSteel** представляет собой комплексное решение для автоматизации работы с марками сталей и сплавов. Проект включает:

- **9,614 марок** из мировых стандартов (ГОСТ, AISI, DIN, JIS, GB)
- **AI-поиск** редких и нестандартных марок через Perplexity
- **Web-интерфейс** с фильтрами и сравнением
- **Telegram-бот** для мобильного доступа
- **Docker контейнеризация** для простого развертывания

**Система готова к production использованию!**

---

*Документ подготовлен: 10 февраля 2026 г.*
*Версия: Production Ready*
*Автор: ParserSteel Team*
