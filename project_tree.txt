╔═══════════════════════════════════════════════════════════════════════════════╗
║                     ДЕРЕВО ПРОЕКТА ParserSteel                                ║
║                   Подготовлено для деплоя на сервер                           ║
║                         Дата: 2026-01-09                                      ║
╚═══════════════════════════════════════════════════════════════════════════════╝

┌─────────────────────────────────────────────────────────────────────────────┐
│  🎯 КРИТИЧНЫЕ ФАЙЛЫ ДЛЯ ДЕПЛОЯ (обязательны для Web + Telegram Bot)        │
└─────────────────────────────────────────────────────────────────────────────┘

ParserSteel/
│
├── 🐳 DOCKER КОНФИГУРАЦИЯ (обязательно):
│   ├── docker-compose.yml          # Оркестрация контейнеров (Flask + Telegram)
│   ├── Dockerfile                  # Docker образ для Flask API
│   └── Dockerfile.telegram         # Docker образ для Telegram бота
│
├── 🐍 ОСНОВНЫЕ ПРИЛОЖЕНИЯ (обязательно):
│   ├── app.py                      # Flask API server (Web UI + REST API)
│   ├── telegram_bot.py             # Telegram bot
│   ├── config.py                   # Конфигурация проекта
│   ├── ai_search.py                # AI Search (Perplexity/OpenAI)
│   ├── context_analyzer.py         # GPT-4o-mini для анализа запросов
│   └── database_schema.py          # Схема БД + миграции
│
├── 📦 ЗАВИСИМОСТИ (обязательно):
│   └── requirements.txt            # Python packages
│
├── 🔒 ENVIRONMENT (обязательно, НЕ коммитить в git!):
│   └── .env                        # API ключи (TELEGRAM_TOKEN, PERPLEXITY_API_KEY, OPENAI_API_KEY)
│
├── 💾 БАЗА ДАННЫХ (обязательно):
│   └── database/
│       └── steel_database.db       # Основная БД: 11 MB, 10,394 марок
│
├── 🎨 FRONTEND (обязательно):
│   ├── templates/
│   │   └── index.html              # Web интерфейс
│   └── static/
│       ├── logo_white.svg          # Логотип ВЭМ (белый для синего фона)
│       └── logo_colored.svg        # Логотип ВЭМ (цветной)
│
└── 📊 CSV ОТЧЕТЫ (опционально, но рекомендуется):
    └── reports/
        ├── zknives_db_updates.csv          # 684 KB - обновления из zknives
        ├── splav_composition_compare.csv   # 694 KB - сравнение составов
        ├── zknives_page_info.csv           # 980 KB - информация о страницах
        └── zknives_mismatches.csv          # 614 KB - несоответствия
        └── splav_ru_grades.csv             # 669 KB - русские марки


┌─────────────────────────────────────────────────────────────────────────────┐
│  📚 ДОПОЛНИТЕЛЬНЫЕ ФАЙЛЫ (не критичны для работы, но полезны)               │
└─────────────────────────────────────────────────────────────────────────────┘

ParserSteel/
│
├── 🔄 ПАРСЕРЫ И СИНХРОНИЗАЦИЯ (для обновления БД, не для деплоя):
│   ├── zknives_page_sync.py         # Парсер zknives.com
│   ├── ru_splav_sync.py             # Парсер splav-kharkov.com (русские марки)
│   ├── ru_metallicheckiy_sync.py   # Парсер metallicheckiy.ru
│   ├── check_compositions.py        # Проверка химических составов
│   └── deduplicate_grades.py       # Удаление дубликатов
│
├── 📋 GIT:
│   └── .gitignore                  # Исключения из git
│
└── 📖 ДОКУМЕНТАЦИЯ (не для деплоя):
    └── docs/
        ├── README.md
        ├── ARCHITECTURE_REPORT.md
        ├── AI_SEARCH_BEHAVIOR.md
        ├── CONCURRENT_AI_ANALYSIS.md
        └── PROJECT_AUDIT_CLEANUP_PLAN.md


┌─────────────────────────────────────────────────────────────────────────────┐
│  ❌ НЕ ПЕРЕНОСИТЬ НА СЕРВЕР (локальные архивы и тесты)                     │
└─────────────────────────────────────────────────────────────────────────────┘

ParserSteel/
│
├── archive/                        # Архивные файлы (старые парсеры/скрипты)
│   ├── old_parsers/                # 4 старых парсера
│   ├── old_scripts/                # 19 старых скриптов
│   └── backup_files/               # Backup файлы
│
├── tests/                          # Тестовые скрипты
│   ├── test_ai_k888.py
│   └── test_concurrent_ai.py
│
├── docs/                           # Документация (хранить в репозитории)
│
└── reports/archive/                # Архивные CSV отчеты


┌─────────────────────────────────────────────────────────────────────────────┐
│  🗑️ УДАЛЕНО (кеш парсеров, не нужен для работы марочника)                  │
└─────────────────────────────────────────────────────────────────────────────┘

❌ reports/splav_cache/             # 52 MB HTML кеш - УДАЛЕНО ✅
❌ reports/metal_cache/             # 49 MB HTML кеш - УДАЛЕНО ✅
❌ reports/zknives_pages/           # 277 MB SHTML кеш - УДАЛЕНО ✅

Освобождено места: 378 MB


╔═══════════════════════════════════════════════════════════════════════════════╗
║                         📊 СТАТИСТИКА ПРОЕКТА                                 ║
╚═══════════════════════════════════════════════════════════════════════════════╝

🎯 МИНИМАЛЬНЫЙ РАЗМЕР ДЛЯ ДЕПЛОЯ:
┌───────────────────────────────┬──────────────┐
│ Компонент                     │ Размер       │
├───────────────────────────────┼──────────────┤
│ База данных (steel_database)  │ 11 MB        │
│ Python код (app + bot + AI)   │ ~60 KB       │
│ Frontend (HTML + SVG)         │ ~30 KB       │
│ Docker конфигурация           │ ~5 KB        │
│ CSV отчеты (опционально)      │ 2.3 MB       │
├───────────────────────────────┼──────────────┤
│ ИТОГО (минимум)               │ ~11 MB       │
│ ИТОГО (с CSV)                 │ ~13 MB       │
└───────────────────────────────┴──────────────┘

📦 Docker образы после сборки: ~500-800 MB
   (включают Python, библиотеки, системные зависимости)


╔═══════════════════════════════════════════════════════════════════════════════╗
║                      🚀 БЫСТРЫЙ ДЕПЛОЙ НА СЕРВЕР                              ║
╚═══════════════════════════════════════════════════════════════════════════════╝

1️⃣ Клонировать репозиторий:
   git clone <repository-url>
   cd ParserSteel

2️⃣ Создать .env файл с API ключами:
   TELEGRAM_TOKEN=your_telegram_bot_token
   PERPLEXITY_API_KEY=your_perplexity_api_key
   OPENAI_API_KEY=your_openai_api_key

3️⃣ Запустить Docker контейнеры:
   docker-compose up -d --build

4️⃣ Проверить статус:
   docker-compose ps
   curl http://localhost:5000/api/steels/count

5️⃣ Открыть Web интерфейс:
   http://your-server-ip:5000


╔═══════════════════════════════════════════════════════════════════════════════╗
║                    ✅ ПРОЕКТ ГОТОВ К ДЕПЛОЮ                                   ║
║                                                                               ║
║  • База данных: 10,394 марок стали                                           ║
║  • Web интерфейс: Рабочий с логотипом ВЭМ                                    ║
║  • Telegram бот: Интегрирован с AI Search                                    ║
║  • AI Search: Perplexity API + OpenAI GPT-4 (fallback)                       ║
║  • Concurrent access: WAL mode + timeout protection                          ║
║  • Размер для переноса: ~13 MB (экономия 97% после очистки)                  ║
╚═══════════════════════════════════════════════════════════════════════════════╝
